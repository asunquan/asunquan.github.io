<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <title>TestFlight——完美的iOS app测试方案</title>
  <meta name="description" content="转载本文请保留以下原作者信息:原作：onevcat http://www.onevcat.com/2012/01/testflight/">
  <meta name="author" content="Wei Wang">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="TestFlight——完美的iOS app测试方案">
  <meta name="twitter:description" content="转载本文请保留以下原作者信息:原作：onevcat http://www.onevcat.com/2012/01/testflight/">
  
  <meta property="og:type" content="article">
  <meta property="og:title" content="TestFlight——完美的iOS app测试方案">
  <meta property="og:description" content="转载本文请保留以下原作者信息:原作：onevcat http://www.onevcat.com/2012/01/testflight/">
  
  <link rel="icon" type="image/png" href="/assets/images/favicon.png" />
  <link href="/assets/images/favicon.png" rel="shortcut icon" type="image/png">
  
  <link rel="stylesheet" href="/css/main.css">
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">

  <link rel="canonical" href="/2012/01/testflight/">
  <link rel="alternate" type="application/rss+xml" title="asunquan.com" href="/feed.xml">
  
  <meta name="google-site-verification" content="1-1ZlHoRvM0T2FqPbW2S-qLgYXN6rsn52kErlMPd_gw" />
  
</head>


  <body>

    <span class="mobile btn-mobile-menu">
        <i class="fa fa-list btn-mobile-menu__icon"></i>
        <i class="fa fa-angle-up btn-mobile-close__icon hidden"></i>
    </span>
    
    <header class="panel-cover panel-cover--collapsed" style="background-image: url('/assets/images/background-cover.jpg')">
  <div class="panel-main">

    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">

        <a href="/#blog" title="前往 asunquan.com 的主页" class="blog-button"><img src="/assets/images/avatar.jpg" width="80" alt="asunquan.com logo" class="panel-cover__logo logo" /></a>
        <h1 class="panel-cover__title panel-title"><a href="/#blog" title="link to homepage for asunquan.com" class="blog-button">asunquan.com</a></h1>

        
        <span class="panel-cover__subtitle panel-subtitle">不忘初心 不止于行</span>
        
        <hr class="panel-cover__divider" />
        <p class="panel-cover__description">职场新人 iOS菜鸟 就职于搜狐畅游 从事iOS/tvOS的SDK开发 对于游戏市场有点点了解 平日和一只小Corgi同吃同睡</p>
        <hr class="panel-cover__divider panel-cover__divider--secondary" />
        
        
        
        <div class="navigation-wrapper">
          <div>
            <nav class="cover-navigation cover-navigation--primary">
              <ul class="navigation">
                <li class="navigation__item"><a href="/#blog" title="访问博客" class="blog-button">博客</a></li>
                
              </ul>
            </nav>
          </div>
          
          <div><nav class="cover-navigation navigation--social">
  <ul class="navigation">

  
  <!-- Weibo -->
  <li class="navigation__item">
    <a href="http://weibo.com/asunquan" title="@asunquan 的微博" target="_blank">
      <i class='social fa fa-weibo'></i>
      <span class="label">Weibo</span>
    </a>
  </li>
  

  
  <!-- Github -->
  <li class="navigation__item">
    <a href="https://github.com/asunquan" title="@asunquan 的 Github" target="_blank">
      <i class='social fa fa-github'></i>
      <span class="label">Github</span>
    </a>
  </li>
  
  
  

  

  <!-- RSS -->
  <li class="navigation__item">
    <a href="/feed.xml" rel="author" title="RSS" target="_blank">
      <i class='social fa fa-rss'></i>
      <span class="label">RSS</span>
    </a>
  </li>

  
  <!-- Email -->
  <li class="navigation__item">
    <a href="mailto:asunquan@gmail.com" title="Contact me">
      <i class='social fa fa-envelope'></i>
      <span class="label">Email</span>
    </a>
  </li>
  

  </ul>
</nav>
</div>
        </div>
      </div>
    </div>
    
    
    <div class="panel-cover--overlay cover-slate"></div>
    
  </div>
</header>


    <div class="content-wrapper">
        <div class="content-wrapper__inner">
            <article class="post-container post-container--single" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    <div class="post-meta">
      <time datetime="2012-01-17 21:17:25 +0800" itemprop="datePublished" class="post-meta__date date">2012-01-17</time> &#8226; <span class="post-meta__tags tags">南箕北斗集</span>
    </div>
    <h1 class="post-title">TestFlight——完美的iOS app测试方案</h1>
  </header>

  <section class="post">
    <p>转载本文请保留以下原作者信息:<br>
原作：onevcat <a href="http://www.onevcat.com/2012/01/testflight/">http://www.onevcat.com/2012/01/testflight/</a></p>

<h2>2014.5.3补充</h2>

<p>TestFlight 现在已经修成正果，被 Apple 高价收购。虽然很遗憾不能再支持 Android 版本，但是有理由相信在 Apple 旗下的 TestFlight 将被深度整合进 Apple 开发的生态体系，并且承担更加重要的作用。不妨期待一下今年的 WWDC 上 Apple 在 CI 方面的进一步动作，预测应该会有 OSX Server 和 TestFlight 的协作方面内容。对于 CI 方面的一些其他介绍，可以参看 objc 中国的<a href="http://objccn.io/issue-6-5/">这篇帖子</a>。</p>

<h2>2013.3.31补充</h2>

<p>在整理以前写的内容，想不到还有机会再对这篇帖子进行一些更新。当时写这篇帖子的时候，app内部测试以及对应的crash报告类的服务相对很少，而且并不成熟。TestFlight算是在这一领域的先行者，而随着app市场的不断膨胀，相应的类似服务也逐渐增多，比较常用的有：</p>

<p>崩溃报告类：</p>

<ul>
<li><a href="https://www.crittercism.com/">Crittercism</a> 个人用了一段时间，表现很稳定，但是版本更新时设置比较麻烦</li>
<li><a href="https://www.crashlytics.com/">Crashlytics</a> 相当优雅方便，最近被Twitter收购。十分推荐</li>
</ul>

<p>用户行为统计类：</p>

<ul>
<li><a href="http://www.flurry.com/">Flurry</a> 这个太有名了，不多说了</li>
<li><a href="http://count.ly/">Countly</a> 好处是轻量开源，数据可以自己掌控</li>
</ul>

<p>但是在“发布前”测试分发这个环节上，基本还没有出现能与TestFlight相匹敌的服务出现，因此如果有这方面的测试需求的话，TF依然是开发人员的首选。</p>

<p>当然，这一年多来，TF也进步了很多。从整个队伍建立和开发者添加开始，到桌面客户端的出现以及打包上传的简化，可以说TF也逐渐向着一个更成熟易用的方向发展。本文虽然写的时间比较早，但是整个TF的基本流程并没有发生变化，依然可以作为入门的参考。</p>

<h2>前言</h2>

<p>iOS开发的测试一直是令人头疼的问题。app开发的短周期和高效率的要求注定了一款app，特别是小公司的app，不会留给开发人员很多测试的时间。而在测试时往往又遇到crash报告提交困难，测试人员与开发人员沟通不便等等问题，极大延缓了测试进度。TestFlight即是为了解决iOS开发时测试的种种困难而生的服务，使用TestFlight可以十分便利地完成版本部署，测试用户Log提交，收集Carsh Log和收集用户反馈等工作，而这一切居然连一个iDP账号都不需要！</p>

<h2>基本使用</h2>

<h3>注册</h3>

<p>TestFlight界面友好，文档齐全，开发者在使用上不会遇到很多问题。到<a href="https://testflightapp.com/">TestFlight官网</a>注册账号即可开始使用。</p>

<p><img src="http://www.onevcat.com/wp-content/uploads/2012/01/TestFlight-%C2%BB-iOS-beta-testing-on-the-fly-2.jpg" alt="注册账号"></p>

<p>注册时记得勾选I am a developer，之后便可以以开发者身份管理开发和测试团队，提交测试版本和查看报告等，若没有勾选则是以测试者身份注册。若在注册时没有选上，之后在帐号设置中也可以进行更改。</p>

<p><img src="http://www.onevcat.com/wp-content/uploads/2012/01/signdetail.jpg" alt="勾选开发者"></p>

<h3>确认</h3>

<p>注册完成以后会在注册邮箱中收到确认邮件。使用你的iDevice用邮件内的帐号登陆，并且完成设备注册，加入TestFlight的描述文件。关于设备注册和可能遇到的问题，可以参看<a href="http://liucheng.easymorse.com/?tag=testflight">这篇帖子</a>。</p>

<h3>创建团队</h3>

<p>登陆TestFlight后在自己的Dashboard可以新建一个团队。团队包括了开发者、测试者和相应的测试版本。创建团队后可以通过选择团队来查看团队的信息等情况。</p>

<p><img src="http://www.onevcat.com/wp-content/uploads/2012/01/addteam1.jpg" alt="建立团队"></p>

<h3>添加测试者</h3>

<p>在团队管理界面可以为团队添加成员。填写受邀者的邮件和简单的说明，一封包含注册链接的邮件将被发送到指定邮箱。受邀者通过类似的注册和确认流程即可加入团队，参与共同开发和测试。</p>

<p><img src="http://www.onevcat.com/wp-content/uploads/2012/01/addteammate.jpg" alt="添加测试者"></p>

<h3>上传测试版本</h3>

<p>上传的版本必须是包含签名的ipa，成功上传版本后即可选择给团队内的成员发邮件或推送邀请他们进行新版本的安装和测试。之后在版本管理中即可看到关于该版本的测试信息。该部分具体内容参看本文最后。</p>

<h3>收集测试信息</h3>

<p>在build界面中选择需要查看的版本的对应按钮即可看到收集到的测试信息，包括一般的session信息，设备使用TFLog进行的输出(需要TestFlight SDK)，crash报告，是否通过了预先设定的检查点，测试人员的安装情况等信息。</p>

<p>结合SDK来使用，一切测试机仿佛都变成了你自己的终端，所有的Log和设备的状态尽在掌握，而这样的便利仅仅需要点击下鼠标和写几行代码，这便是TestFlight的强大之处。</p>

<p><img src="http://www.onevcat.com/wp-content/uploads/2012/01/tfinfo-1024x484.jpg" alt="收集信息"></p>

<h2>TestFlight SDK使用</h2>

<h3>下载</h3>

<p>不使用TestFlight的SDK的话，可以说就连这个强大的平台的一成功力都发挥不出来。点击<a href="https://d3fqheiq7nlyrx.cloudfront.net/sdk-downloads/TestFlightSDK0.8.2.zip">这里</a>从官方网站下载SDK，<a href="https://testflightapp.com/sdk/doc/0.8.2/">官方文档</a>提供了关于SDK的很全面的说明，在<a href="http://support.testflightapp.com/">支持页面</a>也能找到很多有用的信息。</p>

<p>之后将以Xcode4为例，简介SDK的使用，更多信息可以参考TestFlight官网。</p>

<h3>配置</h3>

<ul>
<li><p>将头文件加入工程：File-&gt;Add Files to </p>

<ul>
<li>找到包含SDK的文件夹</li>
<li>勾选&quot;Copy items into destination folder (if needed)&quot;</li>
<li>选择&quot;Create groups for any added folders&quot;</li>
<li>勾上想要使用TestFlight SDK的Target</li>
</ul></li>
<li><p>验证libTestFlight.a是否被加到link部件中 </p>

<ul>
<li>在Project Navigation里选中工程文件</li>
<li>选中想要应用SDK的Target</li>
<li>选择Build Phase栏</li>
<li>打开Link Binary With Libraries Phase</li>
<li>如果libTestFlight.a不在栏内，从Project Navigation里将其拖到栏内</li>
</ul></li>
<li><p>开始使用 </p>

<ul>
<li>在需要用到TestFlight SDK的文件中引入头文件：<em>#import “TestFlight.h”</em>，方便起见，您也可以在工程的预编译文件中的<em>#ifdef __OBJC</em>__块中引入</li>
<li>获取团队token：在<a href="http://testflightapp.com/dashboard/team/">这个页面</a>中对应的团队下选取TeamInfo，获取团队的token。</li>
<li>在AppDelegate中启动TestFlight<br>
<code>objc
–(BOOL)application:(UIApplication *_)application didFinishLaunchingWithOptions:(NSDictionary  _*)launchOptions {  
// start of your application:didFinishLaunchingWithOptions  
// …  
[TestFlight takeOff:@“团队Token”];  
// The rest of your application:didFinishLaunchingWithOptions method  
// …  
}
</code></li>
</ul></li>
</ul>

<p>为了能得到有用的crash log(挂载过的)，必须在生成ipa的时候不剥离.dSYM文件。在Project Navigation里选中工程文件，选中需要使用TestFlight SDK的Target，在Building Setting的Deployment块下，将以下三项设为NO </p>

<ul>
<li>Deployment Post Processing</li>
<li>Strip Debug Symbols During Copy</li>
<li>Strip Linked Product</li>
</ul>

<h3>检查点</h3>

<p>开发者可以在代码的任意位置设置检查点，当测试者通过检查点时，session里将会对此记录。比如测试者通过了某个关卡，或者提交了某个分数，或者向数据库加入了某条信息等。通过验证检查点，一方面可以检测代码是否正确，另一方面也可以作为游戏的平衡性调整和测试，用来检测用户的普遍水平。</p>

<p><img src="http://www.onevcat.com/wp-content/uploads/2012/01/checkpoints.jpg" alt="加入检查点"></p>
<figure class="highlight"><pre><code class="language-objc" data-lang="objc">[TestFlight passCheckpoint:@“CHECKPOINT_NAME”];  
</code></pre></figure>
<h3>检查点问题</h3>

<p>配合检查点可以向测试者提出问题，比如“是否正确地通过了演示界面？”或者“分数榜的提交正常吗？”这样的问题。在build management下可以找到Question选项，为检查点添加问题。问题的回答分为多选，是/否以及任意回答，如果选择多选的话，还需要指出问题的可能的选项。<br>
当测试者通过问题所对应的检查点时，一个modalViewController形式的问题和选项列表会出现供测试者选择。开发者可以在build的Question选项卡中看到反馈。</p>

<h3>反馈</h3>

<p>TestFlight提供了一个默认的反馈界面，测试者可以填写他们想写的任何内容并将这个反馈发送给你。调用一个反馈：</p>
<figure class="highlight"><pre><code class="language-objc" data-lang="objc">–(IBAction)launchFeedback {  
    [TestFlight openFeedbackView];  
}
</code></pre></figure>
<p>一般来说可以在主界面或者最常见的界面上设置一个“反馈”按钮，这样测试者可以很方便地将他们的感受和意见发送给你。</p>

<h3>远程Log</h3>

<p>太棒了…配合TestFlight，现在开发者可以拿到远程客户端的Log。使用<strong>TFLog</strong>代替NSLog即可，任何TFLog的输出将被上传到TestFlight的服务器。如果需要详细一些的输出信息，可以用内建的<strong>参数</strong>的方式输出信息，比如：</p>
<figure class="highlight"><pre><code class="language-objc" data-lang="objc">#define NSLog(__FORMAT__, ...) TFLog((@&quot;%s [Line %d] &quot; __FORMAT__), __PRETTY_FUNCTION__, __LINE__, ##__VA_ARGS__)
</code></pre></figure>
<p>将会得到类似这样的输出</p>
<figure class="highlight"><pre><code class="language-objc" data-lang="objc">-[HTFCheckpointsController showYesNoQuestion:] [Line 45] Pressed YES/NO
</code></pre></figure>
<p>所有的TFLog都不会阻塞主线程，所有的TFLog都将完成以下三种Logger工作</p>

<ul>
<li>TestFlight logger</li>
<li>Apple System Log logger</li>
<li>STDERR logger</li>
</ul>

<p>配合以前介绍过的NSLogger(参见<a href="http://www.onevcat.com/2011/12/nslogger/">这篇文章</a>)，将Log发挥到极致，让你永远掌控自己的代码吧～</p>

<p>Log将会在客户端进入后台或者被退出的时候上传到服务器，如果没有看到应该有的Log的话，很有可能是还在上传中。视Log文件大小而定，一般这个过程需要若干分钟。当然，巨量上几M甚至10+M的Log可能会被TestFlight拒绝哦..毕竟没有那么多存储空间..</p>

<p>当然，客户端必须有可用的网络环境这个功能才会启用。得到的Log会存储在Session下。</p>

<p><img src="http://www.onevcat.com/wp-content/uploads/2012/01/Log.jpg" alt="Session页面"></p>

<h2>生成和上传测试版本</h2>

<h3>打包ipa</h3>

<p>..做过部署的童鞋对这个应该很熟了，官方也有一个详细的guide，总之照着做就没错了</p>

<ul>
<li><a href="http://support.testflightapp.com/kb/tutorials/how-to-create-an-ipa-xcode-3">XCode3如何生成ipa</a></li>
<li><a href="http://support.testflightapp.com/kb/tutorials/how-to-create-an-ipa-xcode-4">Xcode4如何生成ipa</a></li>
</ul>

<h3>上传测试版本</h3>

<p>打包好ipa后就到版本上传界面，把做好的ipa拖过去就万事大吉了。</p>

<p><img src="http://www.onevcat.com/wp-content/uploads/2012/01/ipa.jpg" alt="上传ipa包"></p>

<p>最后一步是邀请团队内的测试者进行测试。把你想邀请的测试者打上勾然后OK，包含链接的邀请邮件将会发到他们的邮箱。然后～等待测试结果和大家的反馈，并且根据反馈完善app吧～</p>

<h2>写在最后</h2>

<p>TestFlight是一个很棒的工具，而且关键，它现在还是免费的～</p>

<p>虽然有趋势以后将会收费，但是这套方案确实是方便易用..希望多支持吧～</p>

  </section>
</article>

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- OneV's Den -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3324997515191619"
     data-ad-slot="9170309685"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<section class="read-more">
   
   
   <div class="read-more-item">
       <span class="read-more-item-dim">最近的文章</span>
       <h2 class="post-list__post-title post-title"><a href="/2012/01/googlelocation/" title="link to Google查询地理信息API">Google查询地理信息API</a></h2>
       <p class="excerpt">向Google Map查询给定经纬度的位置信息，返回为JSON+ (NSString *)googleReverseStringWithCoordinate:(CLLocationCoordinate2D)coordinate {    return [NSString stringWithFormat:@&quot;http://maps.google.com/maps/geo?q=%lf,%lf&amp;output=json&amp;sensor=false&amp;accuracy...&hellip;</p>
       <div class="post-list__meta"><time datetime="2012-01-18 21:24:09 +0800" class="post-list__meta--date date">2012-01-18</time> &#8226; <span class="post-list__meta--tags tags">能工巧匠集</span><a class="btn-border-small" href=/2012/01/googlelocation/>继续阅读</a></div>
   </div>
   
   
   
   
   <div class="read-more-item">
       <span class="read-more-item-dim">更早的文章</span>
       <h2 class="post-list__post-title post-title"><a href="/2012/01/ahrp2012/" title="link to AHRP 2013 内部推荐机会">AHRP 2013 内部推荐机会</a></h2>
       <p class="excerpt">2013秋季项目内推已经结束。如果打算参加的话，可以关注9月份陆续开始的宣讲会和AHRP官方网站的一些信息。谢谢大家对AHRP项目和我的blog的关注～~AHRP新一年的秋季项目即将开始，2012春季项目中博主内推的童鞋中有2人最终拿到了offer，而2013秋季依然我有机会作为内定者为大家进行内推。如果有对该项目感兴趣的童鞋欢迎给我邮件或留言咨询最新情况。此次内推5月26日就将截止，AHRP秋季项目将在6月初和被内推者先行联系，现在申请可以先人一步，将对您求职路上占据主动有很大帮助！~~...&hellip;</p>
       <div class="post-list__meta"><time datetime="2012-01-11 21:14:04 +0800" class="post-list__meta--date date">2012-01-11</time> &#8226; <span class="post-list__meta--tags tags">胡言乱语集</span><a class="btn-border-small" href=/2012/01/ahrp2012/>继续阅读</a></div>
   </div>
   
</section>

<section class="post-comments">
  
    <div id="disqus_thread"></div>
    <script>
    
    var disqus_config = function () {
        this.page.url = "/2012/01/testflight/";
        this.page.identifier = "/2012/01/testflight/";
    };

    var disqus_shortname = 'asunquan';
    
    (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script>
    <noscript>要查看<a href="http://disqus.com/?ref_noscript"> Disqus </a>评论，请启用 JavaScript</noscript>
    
  
  
  
  
</section>


            <section class="footer">
    <footer>
    	<span class="footer__copyright">本站点采用<a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">知识共享 署名-非商业性使用-相同方式共享 4.0 国际 许可协议</a></span>
        <span class="footer__copyright">由 <a href="https://jekyllrb.com">Jekyll</a> 于 2016-11-15 生成，感谢 <a href="https://www.digitalocean.com/?refcode=30ed2d146762">Digital Ocean</a> 为本站提供稳定的 VPS 服务</span>
        <span class="footer__copyright">本站由 <a href="https://github.com/asunquan”>@asunquan</a> 创建，采用 <a href="https://github.com/onevcat/vno-jekyll">Vno - Jekyll</a> 作为主题，您可以在 GitHub 找到<a href="https://github.com/onevcat/OneV-s-Den">本站源码</a> - &copy; 2016</span>
    </footer>
</section>

        </div>
    </div>
    
    <script type="text/javascript" src="//code.jquery.com/jquery-1.11.3.min.js"></script>

<script type="text/javascript" src="/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<script type="text/javascript" src="/js/main.js"></script>


<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-87028002-1', 'www.sunquan.club');
    ga('send', 'pageview');
</script>


    
  </body>

</html>
